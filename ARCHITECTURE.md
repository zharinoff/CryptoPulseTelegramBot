### **Техническое задание (ТЗ) на Telegram-бота для мониторинга цен криптовалют**  
**Цель:** Создать масштабируемого бота для трекинга цен BTC/ETH с Bybit и отправки уведомлений.  

---

## **1. Функционал бота**  
### **Основные функции (v1.0)**  
1. **Работа в личных сообщениях** (chat_id пользователя).  
2. **Парсинг цен BTC и ETH** с Bybit API.  
3. **Автоматическая отправка** данных каждые 10 минут.  
4. **Логирование** действий (успешные запросы, ошибки).  
5. **Конфигурация** через `.env` (токен бота, ключи API Bybit).  

### **Планы масштабирования (v2.0+)**  
- Поддержка **групп и каналов**.  
- **Арбитраж:** сравнение цен на Bybit vs Binance/Kraken.  
- **Расширенные команды** (например, `/stats btc 24h`).  

---

## **2. Выбор библиотек**  
**Минимальный набор (без конфликтов):**  
| Библиотека         | Задача                    |  
|--------------------|---------------------------|  
| `aiogram`          | Работа с Telegram API     |  
| `aiohttp`          | Запросы к Bybit API       |  
| `python-dotenv`    | Загрузка конфига из `.env`|  
| `logging`          | Логирование в файл        |  

---

### **Пояснения:**  
- **`config/.env`**  
  - `TELEGRAM_TOKEN=ваш_токен`  
  - `BYBIT_API_KEY=ключ` (опционально для будущего арбитража).  

- **`src/bot/price_checker.py`**  
  - Функции для запроса цен через Bybit API.  
  - Пример возвращаемых данных: `{"btc": 50000, "eth": 2500}`.  

- **`utils/scheduler.py`**  
  - Использует `threading.Timer`для периодических запросов.  

- **`utils/logger.py`**  
  - Настройка `logging` для записи в `logs/bot.log`.  
  - Формат: `[2023-01-01 12:00:00] INFO: Цены обновлены`.  

- **Схема работы**
  - Bybit WebSocket -(raw data)-> price_checker.py -(parsed data)-> commands.py -> Telegram

---

## **3. Принципы масштабирования**  
1. **Гибкость обработчиков**  
   - Код `commands.py` должен поддерживать как личные чаты, так и группы (проверка `chat.type`).  

2. **Легкое добавление бирж**  
   - Класс `PriceChecker` можно расширить методами для Binance/Kraken.  

3. **Разделение логики**  
   - `price_checker.py` не должен знать о Telegram — только возвращает данные.  

---

## **4. Ограничения и риски**  
- **Bybit API** может иметь лимиты запросов (нужен таймер между запросами).  
- **Telegram-боты** не могут инициировать диалог первыми (только после `/start`).  
- Логирование в файл может привести к его переполнению (нужен `RotatingFileHandler`).  

---

## **5. Что дальше?**  
1. Написать `main.py` (инициализация бота, загрузка `.env`).  
2. Реализовать `price_checker.py` с запросами к Bybit.  
3. Настроить `logging` и периодические задачи.  

**Критерии успеха:**  
- Бот запускается и отвечает на `/start`.  
- Каждые 10 минут присылает актуальные цены.  
- Логи пишутся в файл без ошибок.